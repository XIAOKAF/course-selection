# course-selection 接口文档

## API

### /Sms

#### `/Sms/sendAms` ` POST`

| 请求参数 | 类型 | 说明     |
| -------- | ---- | -------- |
| mobile   | 必选 | 电话号码 |

| 返回参数 | 说明     |
| -------- | -------- |
| code     | 状态码   |
| info     | 返回信息 |

| code | info                | 说明                    |
| ---- | ------------------- | ----------------------- |
| 500  | 服务器错误          | 查询电话号码失败        |
| 400  | 电话号码不存在      | 电话号码不存在          |
| 500  | 服务器错误          | 解析短信配置文件失败    |
| 500  | 服务器错误          | 配置短信失败            |
| 500  | 服务器错误          | 发送短信失败            |
| 500  | 服务器错误          | 将短信储存到redis中失败 |
| 200  | 短信发送成功(p≧w≦q) | 短信发送成功且成功储存  |

#### `/Sms/checkSms` ` Post`

| 请求参数   | 类型 | 说明     |
| ---------- | ---- | -------- |
| mobile     | 必选 | 电话号码 |
| verifyCode | 必选 | 验证码   |

| 返回参数 | 说明     |
| -------- | -------- |
| code     | 状态码   |
| info     | 返回信息 |

| code | info                       | 说明                             |
| ---- | -------------------------- | -------------------------------- |
| 400  | 验证码已过期或电话号码错误 | 验证码已过期或电话号码错误       |
| 500  | 服务器错误                 | 查询验证码失败                   |
| 500  | 服务器错误                 | 验证码没有设置过期时间           |
| 500  | 服务器错误                 | 删除redis中的电话号码-验证码失败 |
| 400  | 验证码错误                 | 验证码错误                       |
| 200  | 验证码正确                 | 验证码正确                       |

### /administrator

#### `/administrator/spiderMan`  `Post`

| 返回参数 | 说明     |
| -------- | -------- |
| code     | 状态码   |
| info     | 返回信息 |

| code | info             | 说明                    |
| ---- | ---------------- | ----------------------- |
| 500  | 服务器错误       | 网页请求失败            |
| 500  | 服务器错误       | 网页请求失败            |
| 500  | 服务器错误       | 解析网页失败            |
| 500  | 服务器错误       | 将汉字转化为拼音失败    |
| 500  | 服务器错误       | 将学生信息导入MySQL失败 |
| 200  | 导入学生数据成功 | 成功导入学生数据        |

#### `adnimistrator/createCurriculum` `POST`

| 请求参数         | 类型 | 说明                             |
| ---------------- | ---- | -------------------------------- |
| courseNumber     | 必选 | 课程编号                         |
| courseName       | 必选 | 课程名称                         |
| courseDepartment | 必选 | 课程所属院系                     |
| courseCredit     | 必选 | 课程学分                         |
| courseType       | 必选 | 课程类型（1表示选修，2表示必修） |
| courseGrade      | 必选 | 课程所属年级                     |
| duration         | 必选 | 课程时长                         |

| 返回参数 | 说明     |
| -------- | -------- |
| code     | 状态码   |
| info     | 返回信息 |

| code | info             | 说明                              |
| ---- | ---------------- | --------------------------------- |
| 400  | 必要字段不能为空 | 部分或全部必选请求参数为空        |
| 500  | 服务器错误       | 查询该课程是否已经存在失败        |
| 400  | 该课程已经存在   | 课程已经被创建过                  |
| 500  | 服务器错误       | 数据类型从string转化为float64失败 |
| 500  | 服务器错误       | 数据类型从string转化为int失败     |
| 500  | 服务器错误       | 将课程信息存入MySQL失败           |
| 500  | 服务器错误       | 将课程信息存入redis失败           |
| 200  | 成功创建课程     | 成功创建课程                      |

#### ` /administrator/detailCurriculum` `POST`

| 请求参数      | 类型 | 说明           |
| ------------- | ---- | -------------- |
| courseNumber  | 必选 | 课程编号       |
| teachingClass | 必选 | 教学班编号     |
| teacherNumber | 必选 | 教师编号       |
| setTime       | 必选 | 教学班开课时间 |

| 返回参数 | 说明     |
| -------- | -------- |
| code     | 状态码   |
| info     | 返回信息 |

| code | info             | 说明                       |
| ---- | ---------------- | -------------------------- |
| 400  | 必要字段不能为空 | 部分或全部必选请求参数为空 |
| 500  | 服务器错误       | 从redis中查询课程编号失败  |
| 400  | 该课程不存在     | 课程编号不存在             |
| 500  | 服务器错误       | 从MySQL中查询教师编号失败  |
| 400  | 教师不存在       | 教师编号不存在             |
| 500  | 服务器错误       | 将教学班信息存入redis失败  |
| 200  | 教学信息设置成功 | 教学信息设置成功           |

#### `/administrator/cancel` `POST`

| 请求参数    | 类型 | 说明           |
| ----------- | ---- | -------------- |
| unifiedCode | 必选 | 学生统一验证码 |

| 返回参数 | 说明     |
| -------- | -------- |
| code     | 状态码   |
| info     | 返回信息 |

| code | info             | 说明                      |
| ---- | ---------------- | ------------------------- |
| 400  | 必要字段不能为空 | 必选请求参数为空          |
| 400  | 该学生不存在     | 统一验证码不存在          |
| 500  | 服务器错误       | 查询学生信息失败          |
| 500  | 服务器错误       | 删除MySQL中的学生信息失败 |
| 500  | 服务器错误       | 删除redis中的学生信息失败 |
| 200  | 已经将该学生删除 | 该生信息删除完毕          |

### /student

#### `/studentRegister` `POST`

| 请求参数    | 类型 | 说明                   |
| ----------- | ---- | ---------------------- |
| unifiedCode | 必选 | 统一验证码             |
| password    | 必选 | 初始密码为姓名小写拼音 |

| 返回参数 | 说明     |
| -------- | -------- |
| code     | 状态码   |
| info     | 返回信息 |

| code | info                                                      | 说明                           |
| ---- | --------------------------------------------------------- | ------------------------------ |
| 400  | 必要字段不能为空                                          | 部分或全部必选请求参数为空     |
| 500  | 服务器错误                                                | 查询统一验证码失败             |
| 400  | 是本校学生(⊙o⊙)吗？                                       | 未查询到该统一验证码           |
| 400  | 密码错误（提示一下哦，初始密码是姓名小写拼音              | 密码错误                       |
| 200  | 亲爱的"+unifiedCode+"，你已经成功激活账户啦！o(*￣▽￣*)ブ | 注册成功（类似于成功激活账户） |

#### `/studentLogin` `POST`

| 请求参数    | 类型 | 说明                             |
| ----------- | ---- | -------------------------------- |
| unifiedCode | 必选 | 统一验证码                       |
| password    | 必选 | 密码                             |
| auth        | 任选 | 是否要七天免密登录（空即表示否定 |

| 返回参数 | 说明     |
| -------- | -------- |
| code     | 状态码   |
| info     | 返回信息 |

| code | info                                     | 说明                                   |
| ---- | ---------------------------------------- | -------------------------------------- |
| 400  | 必要字段不能为空                         | 部分或全部必选请求参数为空             |
| 400  | 服务器错误                               | 查询统一验证码失败                     |
| 400  | 是本校学生(⊙o⊙)吗？                      | 未查询到该统一验证码                   |
| 400  | 密码错误（提示一下哦，初始密码是姓名拼音 | 密码错误                               |
| 500  | 服务器错误                               | 创建token失败                          |
| 500  | 服务器错误                               | 储存token失败                          |
| 200  | token                                    | 登录成功（短期记住登录，无refreshToken |
| 500  | 服务器错误                               | token创建失败                          |
| 500  | 服务器错误                               | refreshToken创建失败                   |
| 500  | 服务器错误                               | 储存token失败                          |
| 500  | 服务器错误                               | 储存refreshToken失败                   |
| 200  | token                                    | 登陆成功（长期记住登录，有refreshToken |

#### `/student/changePassword` `POST`

| 请求参数    | 类型 | 说明   |
| ----------- | ---- | ------ |
| token       | 必选 | token  |
| oldPassword | 必选 | 旧密码 |
| newPassword | 必选 | 新密码 |

| 返回参数 | 说明     |
| -------- | -------- |
| code     | 状态码   |
| info     | 返回信息 |

| code | info                               | 说明              |
| ---- | ---------------------------------- | ----------------- |
| 500  | 服务器错误                         | token解析失败     |
| 400  | 悄悄提醒你，初始验证码为姓名拼音哦 | 旧密码字段为空    |
| 400  | (・∀・新密码是？                   | 新密码字段为空    |
| 500  | 服务器错误                         | 查询旧密码错误    |
| 400  | 旧密码错误                         | 旧密码输入错误    |
| 500  | 服务器错误                         | MySQL更新密码失败 |
| 500  | 服务器错误                         | redis更新密码失败 |
| 200  | 成功♪(^∇^*)                        | 更新密码成功      |

#### `/student/checkCodeForUpdate` `POST`

| 请求参数  | 类型 | 说明       |
| --------- | ---- | ---------- |
| token     | 必选 | token      |
| newMobile | 必选 | 新电话号码 |
| code      | 必选 | 验证码     |

| 返回参数 | 说明     |
| -------- | -------- |
| code     | 状态码   |
| info     | 返回信息 |

| code | info                         | 说明                                            |
| ---- | ---------------------------- | ----------------------------------------------- |
| 400  | 验证码已经过期或电话号码错误 | 验证码已过期或者修改了新电话号码                |
| 500  | 服务器错误                   | 查询验证码失败                                  |
| 500  | 服务器错误                   | 验证码没有设置过期时间，删除电话号码-验证码失败 |
| 400  | 验证码错误                   | 验证码错误                                      |
| 500  | 服务器错误                   | MySQL更新电话号码失败                           |
| 500  | 服务器错误                   | redis更新电话号码失败                           |
| 200  | 电话号码更新成功             | 电话号码更新成功                                |

#### `/student/uodateAvatar` `POST`

| 请求参数 | 类型 | 说明     |
| -------- | ---- | -------- |
| token    | 必选 | token    |
| avatar   | 必选 | 头像文件 |

| 返回参数 | 说明     |
| -------- | -------- |
| code     | 状态码   |
| info     | 返回信息 |

| code | info         | 说明             |
| ---- | ------------ | ---------------- |
| 500  | 服务器错误   | 打开头像文件失败 |
| 500  | 服务器错误   | 删除原有头像失败 |
| 500  | 服务器错误   | 存储头像失败     |
| 200  | 头像更新成功 | 头像更新成功     |

#### `/student/selectInfo` `GET`

| 请求参数 | 类型 | 说明  |
| -------- | ---- | ----- |
| token    | 必选 | token |

| 返回参数 | 说明     |
| -------- | -------- |
| code     | 状态码   |
| info     | 返回信息 |

| code | info              | 说明             |
| ---- | ----------------- | ---------------- |
| 500  | 服务器错误        | 获取学生姓名失败 |
| 500  | 服务器错误        | 获取学生性别失败 |
| 500  | 服务器错误        | string转int失败  |
| 500  | 服务器错误        | 获取学生年级失败 |
| 500  | 服务器错误        | 获取学生班级错误 |
| 500  | 服务器错误        | 获取学生院系错误 |
| 500  | 服务器错误        | 获取学生专业错误 |
| 500  | 服务器错误        | 下载图片错误     |
| 200  | student信息结构体 | 成功返回信息     |

#### `/student/chooseCourse` `POST`

| 请求参数      | 类型 | 说明       |
| ------------- | ---- | ---------- |
| token         | 必选 | token      |
| courseNumer   | 必选 | 课程编号   |
| teachingClass | 必选 | 教学班编号 |

| 返回参数 | 说明     |
| -------- | -------- |
| code     | 状态码   |
| info     | 返回信息 |

| code | info               | 说明                           |
| ---- | :----------------- | ------------------------------ |
| 500  | 服务器错误         | token解析失败                  |
| 400  | 必要字段不能为空   | 部分或全部必选字段为空         |
| 500  | 服务器错误         | 查询课程编号失败               |
| 500  | 服务器错误         | 查询该生是否选择过该课程失败   |
| 400  | 你已经选择过该课程 | 学生重复选择课程               |
| 500  | 服务器错误         | 查询学生已选择课程失败         |
| 500  | 服务器错误         | 查询学生已加入教学班失败       |
| 500  | 服务器错误         | 查询教学班开设时间错误         |
| 500  | 服务器错误         | 查询当前选择教学班开设时间错误 |
| 400  | 课程时间出现冲突   | 课程时间出现冲突               |
| 500  | 服务器错误         | 将选课信息存入redis失败        |
| 500  | 服务器错误         | 将选课信息存入redis失败        |
| 200  | 选课成功           | 选课成功                       |

#### `/student/selection` `POST`

| 请求参数 | 类型 | 说明  |
| -------- | ---- | ----- |
| token    | 必选 | token |

| 返回参数 | 说明     |
| -------- | -------- |
| code     | 状态码   |
| info     | 返回信息 |

| code | info         | 说明                   |
| ---- | ------------ | ---------------------- |
| 500  | 服务器错误   | 解析token失败          |
| 500  | 服务器错误   | 查询课程编号失败       |
| 500  | 服务器错误   | 查询教学班失败         |
| 500  | 服务器错误   | 查询课程学分失败       |
| 500  | 服务器错误   | 查询课程类型错误       |
| 500  | 服务器错误   | 查询教学班开设时间错误 |
| 500  | 服务器错误   | 查询教师编号错误       |
| 500  | 服务器错误   | 查询教师姓名错误       |
| 200  | teachingInfo | 成功返回信息           |

#### `/student/quit` `POST`

| 请求参数     | 类型 | 说明       |
| ------------ | ---- | ---------- |
| token        | 必选 | token      |
| courseNumber | 必选 | 课程编号   |
| classNumber  | 必选 | 教学班编号 |

| 返回参数 | 说明     |
| -------- | -------- |
| code     | 状态码   |
| info     | 返回信息 |

| code | info               | 说明                         |
| ---- | ------------------ | ---------------------------- |
| 500  | 服务器错误         | 解析token失败                |
| 400  | 必要字段不能为空   | 部分或全部必选字段为空       |
| 500  | 服务器错误         | 删除学生信息中的选课记录失败 |
| 500  | 服务器错误         | 删除教学班内的学生信息失败   |
| 200  | 你已成功退出该班级 | 成功返回信息                 |

### /teacher

#### `/teacherLogin` `POST`

| 请求参数   | 类型 | 说明                 |
| ---------- | ---- | -------------------- |
| workNumber | 必选 | 教师工号             |
| pwd        | 必选 | 密码                 |
| auth       | 选填 | 是否授权七天免密登录 |

| 返回参数 | 说明     |
| -------- | -------- |
| code     | 状态码   |
| info     | 返回信息 |

| code | info             | 说明                     |
| ---- | ---------------- | ------------------------ |
| 400  | 必要字段不能为空 | 部分或全部必选字段为空   |
| 500  | 服务器错误       | 查询教师工号是否存在失败 |
| 400  | 该教师不存在     | 教师工号不存在           |
| 500  | 服务器错误       | 查询教师密码错误         |
| 400  | 密码错误         | 密码错误                 |
| 500  | 服务器错误       | 创建token失败            |
| 500  | 服务器错误       | 存储token失败            |
| 500  | 服务器错误       | 创建refreshToken失败     |
| 500  | 服务器错误       | 创建refreshToken失败     |
| 200  | token            | 成功返回信息             |

#### `/teacher/getTeachingClass` `GET`

| 请求参数 | 类型 | 说明  |
| -------- | ---- | ----- |
| token    | 必选 | token |

| 返回参数 | 说明     |
| -------- | -------- |
| code     | 状态码   |
| info     | 返回信息 |

| code | info                            | 说明                   |
| ---- | ------------------------------- | ---------------------- |
| 500  | 服务器错误                      | 解析token失败          |
| 500  | 服务器错误                      | 查询教师所带教学班失败 |
| 500  | 服务器错误                      | 查询课程编号失败       |
| 500  | 服务器错误                      | 查询教学班开设时间失败 |
| 200  | teachingArr(教师所带教学班信息) | 成功返回信息           |

#### `/teacher/studentSelection` `GET`

| 请求参数      | 类型 | 说明   |
| ------------- | ---- | ------ |
| token         | 必选 | token  |
| teachingClass | 必选 | 教学班 |

| 返回参数 | 说明     |
| -------- | -------- |
| code     | 状态码   |
| info     | 返回信息 |

| code | info                             | 说明                       |
| ---- | -------------------------------- | -------------------------- |
| 400  | 必要字段不能为空                 | 必选字段部分或全部为空     |
| 500  | 服务器错误                       | token解析失败              |
| 500  | 服务器错误                       | 查询老师是否教授该班级错误 |
| 400  | 保留彼此的空间，不打扰是你的温柔 | 此教师不教此班级           |
| 500  | 服务器错误                       | 查询选课学生失败           |
| 500  | 服务器错误                       | 获取学生姓名失败           |
| 500  | 服务器错误                       | string转int错误            |
| 500  | 服务器错误                       | 获取学生院系错误           |
| 500  | 服务器错误                       | 获取学生专业错误           |
| 200  | studentArr(选课学生信息)         | 成功返回信息               |

### /course

#### `/course/getAllCourse` `GET`

| 返回参数 | 说明     |
| -------- | -------- |
| code     | 状态码   |
| info     | 返回信息 |

| code | info                         | 说明                        |
| ---- | ---------------------------- | --------------------------- |
| 500  | 服务器错误                   | 获取所有课程编号失败        |
| 500  | 服务器错误                   | 查询课程详情失败            |
| 500  | 服务器错误                   | 将学分转化为float类型失败   |
| 500  | 服务器错误                   | 将课程类型转化为int类型失败 |
| 200  | courseDetailsArr（课程详情） | 成功返回信息                |

